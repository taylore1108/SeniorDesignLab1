<!-- //TODO 
//  The webpage needs the following:
//      1. Graph
//          - needs to show past 300 seconds ****
//          - data needs to be available within 10 sseconds
//          - ability to swap between C/F degrees ******
//          - maxY = 50 C *****
//          - minY 10 C ******
//          - scalable with mouse *****
//          - maxX 300 sec ******
//          - missing data should be visible
//          - should indicate if the sensor is unplugged 
//          - 
//      2. change the number the text is sent to *****
//      

        TODO:
        make the number have limitation that can be sumitted
        finish turn off/on lcd button
        creating conversions for data already shown    
//       -->


<!DOCTYPE HTML>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <style>
    body {
      min-width: 310px;
      max-width: 800px;
      height: 400px;
      margin: 0 auto;
    }

    h2 {
      font-family: Arial;
      font-size: 2.5rem;
      text-align: center;
    }

    h3 {
      text-Align: center;
      font-family: Arial;
    }

    div {
      align-items: center;
    }
 
  </style>
</head>

<body>

  <h3>Four Engineers walk into a bar</h3>
  <div id="chart-temperature" class="container"></div>
    <div>
      <div id="buttonSection" class="container" style="text-align: center;">
        <button>
          Turn on LCD
        </button>
        <button id="degreeButton">Change to Fahrenheit</button>
      </div>
      <form>
        <div style="text-align: center; margin:5px;">
          <label for "phoneInput">Enter your number: </label>
          <input id="phoneInput" type="tel" required name="phoneInput" placeholder="###-###-####"
            pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" />
        </div>
        <div style="text-align: center;">
          <button id="phoneSubmit" type="submit">Submit</button>
          <Label id="phoneDisplay">Num: N\A</label>
        </div>
      </form>
    </div>
</body>
<script>
  var isCelsius = true;
  var graphY_Max = 50;
  var graphY_Min = 10;
  var phoneNumber = "N\\A";
  const degreeBtn = document.getElementById('degreeButton');
  const submitElem = document.getElementById('phoneSubmit');
  // const numDisplay = document.getElementById('phoneDisplay');
  degreeBtn.addEventListener("click", () => {
    isCelsius = !isCelsius;
    if (isCelsius) {
      degreeBtn.textContent = 'Change to Fahrenheit';
      chartT.yAxis[0].setTitle({ text: "Temperature (Celsius)" });
      chartT.yAxis[0].setExtremes(10, 50);
    } else {
      degreeBtn.textContent = 'Change to Celsius';
      chartT.yAxis[0].setTitle({ text: "Temperature (Fahrenheit)" });
      chartT.yAxis[0].setExtremes(10, 122);
    }
  });
  var chartT = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-temperature',
      events: {
        load: function () {
          this.clickedOnce = false;
        },
        click: function () {
          const chart = this;
          if (chart.clickedOnce) {
            chart.zoomOut();
            chart.clickedOnce = false;
          }
        }
      },
    },

    title: { text: 'ECE:4880 Temperature Lab' },

    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: { enabled: true }
      },
      series: {
        color: '#059e8a',
        events: {
          click: function (e) {
            const chart = this.chart,
              yAxis = chart.yAxis[0],
              xAxis = chart.xAxis[0];
            let x,
              y,
              rangeX,
              rangeY;
            if (!chart.clickedOnce) {
              x = xAxis.toValue(e.chartX);
              y = yAxis.toValue(e.chartY);
              rangeX = xAxis.max - xAxis.min;
              rangeY = yAxis.max - yAxis.min;
              xAxis.setExtremes(x - rangeX / 10, x + rangeX / 10, false);
              yAxis.setExtremes(y - rangeY / 10, y + rangeY / 10, false);
              chart.redraw();
              chart.clickedOnce = true;
            } else {
              chart.zoomOut();
              chart.clickedOnce = false;
            }
          }
        }
      },
    },
    xAxis: {
      title: { text: 'Time (Seconds)' },
      type: 'datetime',
      dateTimeLabelFormats: { second: '%S.%L' },
      max: 300,
      min: 0,
      reversed: true,

    },
    yAxis: {
      title: { text: 'Temperature (Celsius)' },
      max: graphY_Max,
      min: graphY_Min,

    },
    series: [{
      name: 'testData',
      data: [10, 20, 30, 40, 50]
    },],
    credits: { enabled: false }
  });
  // setInterval(function ( ) {
  //   var xhttp = new XMLHttpRequest();
  //   xhttp.onreadystatechange = function() {
  //     if (this.readyState == 4 && this.status == 200) {
  //       var x = (new Date()).getTime(),
  //           y = parseFloat(this.responseText);
  //       //console.log(this.responseText);
  //       if(chartT.series[0].data.length > 40) {
  //         chartT.series[0].addPoint([x, y], true, true, true);
  //       } else {
  //         chartT.series[0].addPoint([x, y], true, false, true);
  //       }
  //     }
  //   };
  //   xhttp.open("GET", "/temperature", true);
  //   xhttp.send();
  // }, 30000 ) ;

  function cToF(celsius) {
    var cTemp = celsius;
    var cToFahr = cTemp * 9 / 5 + 32;
    var message = cTemp + '\xB0C is ' + cToFahr + ' \xB0F.';
  }

  submitElem.addEventListener('click', function handleClick(event) {
    event.preventDefault();
    const numInput = document.getElementById('phoneInput');
    phoneNumber = numInput.value;
    numInput.value = '';
    const numDisplay = document.getElementById('phoneDisplay');
    numDisplay.innerHTML = 'Num:' + phoneNumber;
  });

</script>

</html>